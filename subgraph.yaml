specVersion: 1.0.0
indexerHints:
  prune: auto
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: CloneFactory
    network: flare
    source:
      abi: CloneFactory
      address: "0x67fe33484cAF1a8D716b84b779569f79881788Ae"
      startBlock: 36028901
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - CycloVault
        - CycloReceipt
      abis:
        - name: CloneFactory
          file: ./lib/rain.factory/out/CloneFactory.sol/CloneFactory.json
      eventHandlers:
        - event: NewClone(address,address,address)
          handler: handleNewClone
      file: ./src/cloneFactory.ts

  - kind: ethereum
    name: LiquidityV3
    network: flare
    source:
      address: "0xee5ff5bc5f852764b5584d92a4d592a53dc527da"
      abi: LiquidityV3
      startBlock: 30718579
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/liquidity.ts
      entities:
        - Account
        - LiquidityV2OwnerBalance
        - LiquidityV3OwnerBalance
        - LiquidityV3Change
        - EligibleTotals
        - VaultBalance
        - CycloVault
      abis:
        - name: LiquidityV3
          file: ./abis/LiquidityV3Manager.json
        - name: factory
          file: ./abis/factory.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleLiquidityV3Transfer

templates:
  - kind: ethereum/contract
    name: CycloVaultTemplate
    network: flare
    source:
      abi: CycloVault
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Account
        - Transfer
        - LiquidityV2OwnerBalance
        - LiquidityV3OwnerBalance
        - LiquidityV2Change
        - LiquidityV3Change
        - EligibleTotals
        - VaultBalance
        - CycloVault
      abis:
        - name: CycloVault
          file: ./lib/cyclo.sol/out/CycloVault.sol/CycloVault.json
        - name: factory
          file: ./abis/factory.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
          receipt: true
      file: ./src/cys-flr.ts

  - kind: ethereum/contract
    name: CycloReceiptTemplate
    network: flare
    source:
      abi: CycloReceipt
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Account
        - ReceiptOwnerBalance
      abis:
        - name: CycloReceipt
          file: ./lib/cyclo.sol/out/CycloReceipt.sol/CycloReceipt.json
      eventHandlers:
        - event: TransferSingle(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleReceiptTransferSingle
        - event: TransferBatch(indexed address,indexed address,indexed address,uint256[],uint256[])
          handler: handleReceiptTransferBatch
      file: ./src/receipt.ts

  - kind: ethereum/contract
    name: LiquidityV2
    network: flare
    source:
      abi: LiquidityV2
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/liquidity.ts
      entities:
        - Account
        - LiquidityV2OwnerBalance
        - LiquidityV3OwnerBalance
        - LiquidityV2Change
        - EligibleTotals
        - VaultBalance
        - CycloVault
      abis:
        - name: LiquidityV2
          file: ./abis/cysFLR.json
        - name: factory
          file: ./abis/factory.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleLiquidityV2Transfer
